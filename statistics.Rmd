---
title: "Group 1 Midterm"
author: "Evelyn Campo, Xiao Qi, Nusrat Prithee"
date: "today"
# date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r init, include=FALSE}
library(ezids)
library(ggplot2)
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3) 
```

Importing the Dataset assigning "NA" to all blank cells
```{r}
tvdata <- read.csv("tv_shows.csv", header=T, na.strings=c("","NA")) 
```


Cleaning the Dataset
```{r}
library(dplyr)
tvdata$IMDb<-gsub("/10","",as.character(tvdata$IMDb)) #We had to delete the character /10 on every observation 
tvdata$Rotten.Tomatoes<-gsub("/100","",as.character(tvdata$Rotten.Tomatoes)) #We had to delete the character /100 on every observation 
tvdata$IMDb<-as.double(tvdata$IMDb) #as.double is a generic function. It is identical to as. numeric
tvdata$Rotten.Tomatoes<-as.double(tvdata$Rotten.Tomatoes) #as.double is a generic function. It is identical to as. numeric
tvdata = select(tvdata, -X, -ID, -Type) #This variables aren't of our interest

str(tvdata)
View(tvdata)
```

Counting missing values 
```{r}
sum(is.na(tvdata)) #Total NA
mean(is.na(tvdata))

#NA per variables
sum(is.na(tvdata$Title))
sum(is.na(tvdata$Year))
sum(is.na(tvdata$Age))
sum(is.na(tvdata$IMDb))
sum(is.na(tvdata$`Rotten Tomatoes`))
sum(is.na(tvdata$Netflix))
sum(is.na(tvdata$Hulu))
sum(is.na(tvdata$`Prime Video`))
sum(is.na(tvdata$`Disney+`))

```
Age has the most missing values in the Dataset, and IMDb is the other variable with NA values.

Streaming platforms into as.factor()
```{r}
tv_shows$Netflix <- as.factor(tv_shows$Netflix)  
tv_shows$Hulu <- as.factor(tv_shows$Hulu)  
tv_shows$`Prime Video` <- as.factor(tv_shows$`Prime Video`)
tv_shows$`Disney+` <- as.factor(tv_shows$`Disney+`)

```
The streaming platforms are categorical. 1 represents if the TV show is found on their platform otherwise 0.


Bar chart for age
```{r}
library(ggplot2)
ggplot(data = na.omit(tvdata), aes(Age)) + 
  geom_bar(col="red", 
                 fill="blue", 
                 alpha = .7) + # opacity
  labs(title="Bar chart target age of viewers") +
  labs(x="Target age of viewers ", y="Frequency")
#We needed to make blank observations (missing values) into NA so that they don't get counted on the graphs
```

Histogram for year 
```{r}
library(ggplot2)
ggplot(data=tvdata, aes(Year)) + 
  geom_histogram(bins = 30,
                 col="red", 
           fill="blue", 
           alpha = .7) + # opacity
  labs(title="Histogram year during which 
       a tv show was produced") +
  labs(x="Year tv show was produced", y="Frequency")
```

Just undertanding a lilttle more about streaming platform variables and age
```{r}

print("Age:")
table(tvdata$Age)
print("Netflix:")
table(tvdata$Netflix)
print("Hulu:")
table(tvdata$Hulu)
print("Prime Video:")
table(tvdata$Prime.Video)
print("Disney:")
table(tvdata$Disney.)

```


What are the most targeted age groups for the TV shows by Netflix, Hulu, Prime, disney
Video? 

```{r}

print("Age:")
table(tvdata$Age)
prop.table(table(tvdata$Age))

ggplot(data = na.omit(tvdata), aes(Age)) + 
  geom_bar(col="red", 
                 fill="blue", 
                 alpha = .7) + # opacity
  labs(title="Most targeted age group for all platforms: 16+ ") +
  labs(x="Target age of viewers ", y="Frequency")

#I am taking this graph from above since it works for this question
```
people who are 16 and older are the most targeted age groups for the tv shows among the all steamming platfrom.

.Which year published the highest number of TV shows? 
```{r}
print("Year:")
table(tvdata$Year)
library(ggplot2)
ggplot(data=tvdata, aes(Year)) + 
  geom_histogram(bins = 30,
                 col="red", 
           fill="blue", 
           alpha = .7) + # opacity
  labs(title="Year during which the highest number of shows were published: 2017") +
  labs(x="Year tv show was published", y="Frequency")
#I am replacing the prevous code with the graphs from above to keep the same formatting
```
The highest number of TV shows were published in 2017 (685) and 2018 (562).And the histogram is right skewed which indicates that video publication is raising while time goes forward.

Normality check of Variables

```{r}

netflixtv <- subset(tvdata, Netflix==1)
hulutv <- subset(tvdata, Hulu==1)
primetv <- subset(tvdata, Prime.Video==1)
disneytv <- subset(tvdata, Disney.==1)

```

Which streaming platform has the highest average rating (according to Rotten 
Tomatoes and IMDb)? 

```{r q06}
net_rating<-t.test(netflixtv$IMDb,netflixtv$Rotten.Tomatoes)
net_rating
hulu_rating<-t.test(hulutv$IMDb,hulutv$Rotten.Tomatoes)
hulu_rating
prime_rating<-t.test(primetv$IMDb,primetv$Rotten.Tomatoes)
prime_rating
disney_rating<-t.test(disneytv$IMDb,disneytv$Rotten.Tomatoes)
disney_rating
```
 Prime Videos has the highest average Imdb rating  which is 7.152538. Also, Netflix has the highest average RTT rating  which is 53.559107
 
Normality check for the variable IMDb and Rotten.Tomatoes
```{r}
shapiro.test(netflixtv$IMDb)
shapiro.test(netflixtv$Rotten.Tomatoes)

library(ggplot2)
ggplot(data=netflixtv,aes(x=IMDb,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="Netflix IMDb histogram") +
labs(x="IMDB", y="frequency")

ggplot(data=netflixtv,aes(x=Rotten.Tomatoes,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="Netflix Rotten.Tomatoes histogram") +
labs(x="Rotten.Tomatoes", y="frequency")


```
Here p value for IMDb and Rotten.Tomatoes is less than 0.05 for Netflix. That's mean these are not normally distributed. Histogram of IMDb is right-skewed also Histogram of Rotten.Tomatoes is slightly left-skewed.
```{r}
shapiro.test(hulutv$IMDb)
shapiro.test(hulutv$Rotten.Tomatoes)

library(ggplot2)
ggplot(data=hulutv,aes(x=IMDb,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="Hulu IMDb histogram") +
labs(x="IMDB", y="frequency")

ggplot(data=hulutv,aes(x=Rotten.Tomatoes,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="hulu Rotten.Tomatoes histogram") +
labs(x="Rotten.Tomatoes", y="frequency")

```
Here p value for IMDb and Rotten.Tomatoes is less than 0.05 for Hulu. That's mean these are not normally distributed. Histogram of IMDb is right-skewed also Histogram of Rotten.Tomatoes is slightly Bimodal.
```{r}
shapiro.test(primetv$IMDb)
shapiro.test(primetv$Rotten.Tomatoes)
library(ggplot2)
ggplot(data=primetv,aes(x=IMDb,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="prime IMDb histogram") +
labs(x="IMDB", y="frequency")

ggplot(data=primetv,aes(x=Rotten.Tomatoes,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="prime Rotten.Tomatoes histogram") +
labs(x="Rotten.Tomatoes", y="frequency")

```
Here p value for IMDb and Rotten.Tomatoes is less than 0.05 for Prime Videos. That's mean these are not normally distributed. Histogram of IMDb is right-skewed also Histogram of Rotten.Tomatoes is Randomly distribution.

```{r}
shapiro.test(disneytv$IMDb)
shapiro.test(disneytv$Rotten.Tomatoes)
library(ggplot2)
ggplot(data=disneytv,aes(x=IMDb,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="disney IMDb histogram") +
labs(x="IMDB", y="frequency")

ggplot(data=disneytv,aes(x=Rotten.Tomatoes,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="disney Rotten.Tomatoes histogram") +
labs(x="Rotten.Tomatoes", y="frequency")

```
Here p value for IMDb and Rotten.Tomatoes is less than 0.05 for Disney+. That's mean these are not normally distributed. Histogram of IMDb is slightly right-skewed and randomly distributed. also Histogram of Rotten.Tomatoes is slightly left-skewed and randomly distribution.

Test of Independence. To check whether IMDb and RRT is independent.
```{r }
contable1= table(netflixtv$Age, netflixtv$IMDb)
contable1
chitest1 = chisq.test(contable1)
chitest1

contable2 = table(netflixtv$Age, netflixtv$Rotten.Tomatoes)
contable2
chitest2 = chisq.test(contable2)
chitest2


```
Here p(0.02316)<0.05 rejects null Hypothesis. That's why IMDb and Rotten.Tomatoes for Netflix  are not independent.

```{r }
contable3= table(hulutv$Age, hulutv$IMDb)
contable3
chitest3 = chisq.test(contable3)
chitest3

contable4 = table(hulutv$Age, hulutv$Rotten.Tomatoes)
contable4
chitest4 = chisq.test(contable4)
chitest4

```
Here p<0.05 rejects null Hypothesis. That's why IMDb and Rotten.Tomatoes for Hulu  are not independent.

```{r}
contable5= table(primetv$Age, primetv$IMDb)
contable5
chitest5 = chisq.test(contable5)
chitest5

contable6 = table(primetv$Age, primetv$Rotten.Tomatoes)
contable6
chitest6 = chisq.test(contable6)
chitest6

```
Here p<0.05 rejects null Hypothesis. That's why IMDb and Rotten.Tomatoes for prime videos  are not independent.

```{r}
contable7= table(disneytv$Age, disneytv$IMDb)
contable7
chitest7 = chisq.test(contable7)
chitest7

contable8 = table(disneytv$Age, disneytv$Rotten.Tomatoes)
contable8
chitest8= chisq.test(contable8)
chitest8

```
Here p<0.05 rejects null Hypothesis. That's why IMDb and Rotten.Tomatoes for Disney  are not independent.
