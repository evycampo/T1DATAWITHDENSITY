---
title: "Group 1 Midterm"
author: "Evelyn Campo, Xiao Qi, Nusrat Prithee"
date: "today"
# date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '3'
---

```{r init, include=FALSE}
library(ezids)
library(ggplot2)
knitr::opts_chunk$set(warning = F, results = "hide", message = F)
options(scientific=T, digits = 3) 
```


```{r}

tvdata <- data.frame(read.csv("tv_shows.csv"))
tvdata$IMDb<-gsub("/10","",as.character(tvdata$IMDb))
tvdata$Rotten.Tomatoes<-gsub("/100","",as.character(tvdata$Rotten.Tomatoes))
tvdata$IMDb<-as.double(tvdata$IMDb)
tvdata$Rotten.Tomatoes<-as.double(tvdata$Rotten.Tomatoes)
tvdata$Netflix<-as.factor(tvdata$Netflix)
tvdata$Hulu<-as.factor(tvdata$Hulu)
tvdata$Prime.Video<-as.factor(tvdata$Prime.Video)
tvdata$Disney.<-as.factor(tvdata$Disney.)
str(tvdata)
View(tvdata)


```

What are the most targeted age groups for the TV shows by Netflix, Hulu, Prime, disney
Video? 

```{r}

print("Age:")
table(tvdata$Age)

```
 people who are 16 and older are the most targeted age groups for the tv shows among the all steamming platfrom.

.Which year published the highest number of TV shows? 
```{r}
print("Year:")
table(tvdata$Year)
library(ggplot2)
ggplot(data=tvdata,aes(x=Year,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="Year histogram") +
labs(x="Year", y="frequency")

```
Normality check of Variables

the highest number of TV shows published in 2017 where 2018 is in the second highest.
```{r}

netflixtv <- subset(tvdata, Netflix==1)
hulutv <- subset(tvdata, Hulu==1)
primetv <- subset(tvdata, Prime.Video==1)
disneytv <- subset(tvdata, Disney.==1)

```

Which streaming platform has the highest average rating (according to Rotten 
Tomatoes and IMDb)? 

```{r q06}
net_rating<-t.test(netflixtv$IMDb,netflixtv$Rotten.Tomatoes)
net_rating
hulu_rating<-t.test(hulutv$IMDb,hulutv$Rotten.Tomatoes)
hulu_rating
prime_rating<-t.test(primetv$IMDb,primetv$Rotten.Tomatoes)
prime_rating
disney_rating<-t.test(disneytv$IMDb,disneytv$Rotten.Tomatoes)
disney_rating
```
 Prime Videos has the highest average Imdb rating  which is 7.152538. Also, Netflix has the highest average RTT rating  which is 53.559107
 
Normality check for the variable IMDb and Rotten.Tomatoes
```{r}
shapiro.test(netflixtv$IMDb)
shapiro.test(netflixtv$Rotten.Tomatoes)

library(ggplot2)
ggplot(data=netflixtv,aes(x=IMDb,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="Netflix IMDb histogram") +
labs(x="IMDB", y="frequency")

ggplot(data=netflixtv,aes(x=Rotten.Tomatoes,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="Netflix Rotten.Tomatoes histogram") +
labs(x="Rotten.Tomatoes", y="frequency")


```
Here p value for IMDb and Rotten.Tomatoes is less than 0.05 for Netflix. That's mean these are not normally distributed. Histogram of IMDb is right-skewed also Histogram of Rotten.Tomatoes is slightly left-skewed.
```{r}
shapiro.test(hulutv$IMDb)
shapiro.test(hulutv$Rotten.Tomatoes)

library(ggplot2)
ggplot(data=hulutv,aes(x=IMDb,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="Hulu IMDb histogram") +
labs(x="IMDB", y="frequency")

ggplot(data=hulutv,aes(x=Rotten.Tomatoes,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="hulu Rotten.Tomatoes histogram") +
labs(x="Rotten.Tomatoes", y="frequency")

```
Here p value for IMDb and Rotten.Tomatoes is less than 0.05 for Hulu. That's mean these are not normally distributed. Histogram of IMDb is right-skewed also Histogram of Rotten.Tomatoes is slightly Bimodal.
```{r}
shapiro.test(primetv$IMDb)
shapiro.test(primetv$Rotten.Tomatoes)
library(ggplot2)
ggplot(data=primetv,aes(x=IMDb,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="prime IMDb histogram") +
labs(x="IMDB", y="frequency")

ggplot(data=primetv,aes(x=Rotten.Tomatoes,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="prime Rotten.Tomatoes histogram") +
labs(x="Rotten.Tomatoes", y="frequency")

```
Here p value for IMDb and Rotten.Tomatoes is less than 0.05 for Prime Videos. That's mean these are not normally distributed. Histogram of IMDb is right-skewed also Histogram of Rotten.Tomatoes is Randomly distribution.

```{r}
shapiro.test(disneytv$IMDb)
shapiro.test(disneytv$Rotten.Tomatoes)
library(ggplot2)
ggplot(data=disneytv,aes(x=IMDb,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="disney IMDb histogram") +
labs(x="IMDB", y="frequency")

ggplot(data=disneytv,aes(x=Rotten.Tomatoes,)) + 
geom_histogram(col="red", 
               fill="green", 
               alpha = .7) + 
labs(title="disney Rotten.Tomatoes histogram") +
labs(x="Rotten.Tomatoes", y="frequency")

```
Here p value for IMDb and Rotten.Tomatoes is less than 0.05 for Disney+. That's mean these are not normally distributed. Histogram of IMDb is slightly right-skewed and randomly distributed. also Histogram of Rotten.Tomatoes is slightly left-skewed and randomly distribution.